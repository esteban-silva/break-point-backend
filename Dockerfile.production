FROM node:16

RUN npm install -g ts-node 

WORKDIR /app

COPY package*.json ./

COPY . .

RUN npm install && npm run build

ENV NODE_ENV=production 
ENV DATABASE_NAME=$DATABASE_NAME  
ENV DATABASE_USERNAME=$DATABASE_USERNAME
ENV DATABASE_PASSWORD=$DATABASE_PASSWORD
ENV DATABASE_HOST=$DATABASE_HOST
ENV DATABASE_PORT=$DATABASE_PORT
ENV PORT=$PORT

EXPOSE 3001

CMD [ "npm", "run", "start" ]